"""
Проект: GigaChat_Content_Assistant
Версия: 1.0
Статус: Первая deploy версия

Модуль: main.py
Разработчик: GEN AI + @AI_NeuroStaff / Dubinin Vladimir

Data Schemas: Строгая типизация и валидация
===========================================

Модуль содержит декларативные модели данных (схемы) на базе библиотеки Pydantic.
Он выполняет роль "контракта" между неструктурированным ответом нейросети (LLM) 
и строгой бизнес-логикой приложения.

Основные возможности:
- Защита от галлюцинаций LLM: валидация типов данных (например, чтобы номер недели всегда был числом).
- Описание структуры ожидаемого JSON-массива от GigaChat.
- Автоматическая конвертация сырых словарей (dict) в удобные Python-объекты.

Классы (Схемы):
- ContentPlanItem (BaseModel):
    Схема единичного элемента контент-плана. Описывает конкретный пост, 
    включая его расписание (неделя, день), тему, площадку (канал) и формат.
- ContentPlan (BaseModel):
    Корневая схема, представляющая весь сгенерированный план целиком. 
    Содержит список валидированных объектов ContentPlanItem.

Связи с другими модулями:
- src.services.content_gen:
    Импортирует ContentPlan и ContentPlanItem для парсинга и валидации 
    сырого JSON-ответа внутри функции generate_content_plan.
- src.views.plan_tab:
    Вызывает метод .model_dump() у возвращенных объектов схем для их конвертации 
    в плоский словарь, который затем используется библиотекой Pandas для отрисовки таблицы.
"""

from typing import List
from pydantic import BaseModel, Field

class ContentPlanItem(BaseModel):
    """
    Схема отдельного поста в контент-плане.
    Служит контрактом для маппинга JSON-полей, которые генерирует LLM 
    (на основе инструкций из промпта content_plan.txt).
    """
    week: int = Field(..., description="Номер недели публикации (целое число)")
    day: str = Field(..., description="День недели (строка, например, 'Понедельник')")
    topic: str = Field(..., description="Тема или заголовок поста (строка)")
    channel: str = Field(..., description="Канал или площадка для размещения (строка)")
    format: str = Field(..., description="Рекомендуемый формат контента (строка, например, 'Текст + Фото')")

class ContentPlan(BaseModel):
    """
    Схема всего контент-плана.
    Обертка над массивом постов, позволяющая Pydantic валидировать 
    сразу весь список сгенерированных элементов одной командой.
    """
    items: List[ContentPlanItem] = Field(..., description="Список сгенерированных объектов постов")